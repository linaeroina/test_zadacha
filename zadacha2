import pandas as pd

# Список активностей проекта (из плана)
activities = [
    "Инициация проекта",
    "Лабораторные испытания",
    "Доклинические исследования",
    "Разработка технологии производства",
    "Клинические испытания",
    "Регистрация и одобрение",
    "Маркетинг и продвижение",
    "Запуск производства",
    "Постмаркетинговый мониторинг"
]

# Список стейкхолдеров (из задачи 1)
stakeholders = [
    "Генеральный директор",
    "Иванов И.И. (лаборатория)",
    "Руководитель клинических исследований",
    "Медицинские эксперты (MD)",
    "Технолог производства",
    "Маркетолог",
    "Дарья (HR)",
    "ООО «Препарат 1»"
]
# Словарь с распределением RACI (R=Responsible, A=Accountable, C=Consulted, I=Informed)
raci_rules = {
    "Инициация проекта": {
        "Генеральный директор": "A",
        "Дарья (HR)": "R",
        "Иванов И.И. (лаборатория)": "C",
        "Руководитель клинических исследований": "C",
        "Медицинские эксперты (MD)": "C",
        "Технолог производства": "C",
        "Маркетолог": "C",
        "ООО «Препарат 1»": "I"
    },
    "Лабораторные испытания": {
        "Иванов И.И. (лаборатория)": "R",
        "Руководитель клинических исследований": "A",
        "Медицинские эксперты (MD)": "C"
    },
    "Доклинические исследования": {
        "Руководитель клинических исследований": "R",
        "Медицинские эксперты (MD)": "A"
    },
    "Разработка технологии производства": {
        "Технолог производства": "R",
        "ООО «Препарат 1»": "A"
    },
    "Клинические испытания": {
        "Медицинские эксперты (MD)": "R",
        "Руководитель клинических исследований": "A",
        "Дарья (HR)": "C"
    },
    "Регистрация и одобрение": {
        "Дарья (HR)": "R",
        "Генеральный директор": "A",
        "Руководитель клинических исследований": "C",
        "Медицинские эксперты (MD)": "C"
    },
    "Маркетинг и продвижение": {
        "Маркетолог": "R",
        "Дарья (HR)": "A"
    },
    "Запуск производства": {
        "Технолог производства": "R",
        "ООО «Препарат 1»": "A"
    },
    "Постмаркетинговый мониторинг": {
        "Медицинские эксперты (MD)": "R",
        "Руководитель клинических исследований": "C",
        "Маркетолог": "C"
    }
}
# Создаем DataFrame с активностями и стейкхолдерами
raci_matrix = pd.DataFrame(index=activities, columns=stakeholders)

# Заполняем матрицу значениями из словаря raci_rules
for activity in activities:
    for stakeholder in stakeholders:
        raci_matrix.loc[activity, stakeholder] = raci_rules.get(activity, {}).get(stakeholder, "I")

# Заменяем NaN на "I" (Informed)
raci_matrix.fillna("I", inplace=True)
# Сохраняем в CSV
raci_matrix.to_csv("raci_matrix.csv", encoding="utf-8-sig")  # utf-8-sig для корректного отображения кириллицы в Excel

# Красиво выводим в консоль
print("RACI-матрица проекта разработки вакцины:\n")
print(raci_matrix)


